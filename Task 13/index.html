<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <title>Обработчики событий на JS</title>
  </head>
  <body>
    <section>
      <div class="captcha-window">
        <h1>Капча на JS</h1>
        <div>
          <div class="captcha-panel">
            <div>
              <img src="color noise.jpg" alt="color-noise" />
              <span class="captcha-text">AnopRH</span>
            </div>
            <button onclick="updateCaptcha()">
              <i class="fi fi-rr-rotate-right"></i>
            </button>
          </div>
        </div>
        <div class="captcha-input-div">
          <input
            class="captcha-input"
            type="text"
            placeholder="Введите капчу"
          />
          <button onclick="checkCaptcha()">Проверить</button>
        </div>
        <span class="result-message"></span>
      </div>
      <script>
        const generateCaptcha = (length) => {
          let result = "";
          let characters =
            "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
          for (let i = 0; i < length; i++) {
            result += characters.charAt(
              Math.floor(Math.random() * characters.length)
            );
          }
          return result;
        };
        const checkCaptcha = () => {
          if (captchaInput.value == captcha) {
            resultText.innerHTML = "Круто! Похоже, Вы не робот";
            resultText.style.color = "#1DD620";
            let lastCaptcha = captcha;
            setTimeout(() => {
              if (lastCaptcha === captcha) {
                updateCaptcha();
              }
            }, 3000);
          } else {
            resultText.innerHTML = "Неверная капча! Попробуйте ещё раз";
            resultText.style.color = "red";
          }
        };
        let captchaText = document.querySelector(".captcha-text");
        let captchaInput = document.querySelector(".captcha-input");
        let resultText = document.querySelector(".result-message");
        let captcha;
        const updateCaptcha = () => {
          captcha = generateCaptcha(6);
          captchaText.innerHTML = captcha;
          resultText.innerHTML = "";
          captchaInput.value = "";
        };
        updateCaptcha();
      </script>
    </section>
    <section class="timeout-section">
      <div>
        <h1>Трепещите! Сессия уже близко!</h1>
        <div class="timer-divs">
          <div>
            <h2 class="days">36</h2>
            <span>Дней</span>
          </div>
          <div>
            <h2 class="hours">1</h2>
            <span>Часов</span>
          </div>
          <div>
            <h2 class="minutes">14</h2>
            <span>Минут</span>
          </div>
          <div>
            <h2 class="seconds">44</h2>
            <span>Секунд</span>
          </div>
        </div>
        <img src="student.jpg" alt="student" />
      </div>
      <script>
        let days = document.querySelector(".days");
        let hours = document.querySelector(".hours");
        let minutes = document.querySelector(".minutes");
        let seconds = document.querySelector(".seconds");
        const endTime = new Date("2022-12-23T09:00:00");
        const updateTimer = () => {
          if (new Date() > endTime) {
            clearInterval(timer);
          } else {
            let timeDiff = Math.floor((endTime - new Date()) / 1000);
            days.innerText = Math.floor(timeDiff / 60 / 60 / 24);
            hours.innerText = Math.floor((timeDiff / 60 / 60) % 24);
            minutes.innerText = Math.floor((timeDiff / 60) % 60);
            seconds.innerText = Math.floor(timeDiff % 60);
          }
        };
        let timer = setInterval(updateTimer, 1000);
        updateTimer();
      </script>
    </section>
    <section id="search-section">
      <div class="search">
        <i class="fi fi-br-search" onclick="toggleSearch()"></i>
        <div>
          <input type="text" placeholder="Поиск" />
          <i
            class="fi fi-rr-cross-small clear-search"
            onclick="clearSearch()"
          ></i>
        </div>
      </div>
      <div class="close-trigger"></div>
      <script>
        let searchCloseTrigger = document.querySelector(".close-trigger");
        let searchPanel = document.querySelector(".search");
        let searchInput = searchPanel.querySelector("input");
        let opened = false;
        const toggleSearch = () =>
          (opened = !opened)
            ? searchPanel.classList.add("opened")
            : searchPanel.classList.remove("opened");
        searchCloseTrigger.onclick = () => {
          opened = false;
          searchPanel.classList.remove("opened");
        };
        const clearSearch = () => (searchInput.value = "");
      </script>
    </section>
    <section>
      <div class="scientist-card">
        <img src="jejnshtejn.jpg" alt="jejnshtejn" />
        <div>
          <h2>Альберт Эйнштейн</h2>
          <h4>Ульм, Германская империя</h4>
          <p>
            Физик-теоретик, один из основателей современной теоретической физики
          </p>
          <div class="buttons">
            <button>Сообщение</button>
            <button>Подписаться</button>
          </div>
          <div class="social-buttons">
            <i class="fi fi-brands-facebook"></i>
            <i class="fi fi-brands-twitter"></i>
            <i class="fi fi-brands-instagram"></i>
          </div>
        </div>
      </div>
      <script>
        const scientistCard = document.querySelector(".scientist-card");
        const scientistImage = scientistCard.querySelector("img");
        let toggle = false;
        scientistImage.onclick = () => {
          (toggle = !toggle)
            ? scientistImage.classList.add("opened")
            : scientistImage.classList.remove("opened");
        };
        scientistCard.onmouseleave = () => {
          scientistImage.classList.remove("opened");
        };
      </script>
    </section>
    <section>
      <div class="stats">
        <div>
          <img src="youtube.svg" alt="youtube" />
          <h4 class="youtube-value"></h4>
          <h3>Просмотров</h3>
        </div>
        <div>
          <img src="linkedin.svg" alt="linkedin" />
          <h4 class="linkedin-value"></h4>
          <h3>Проектов</h3>
        </div>
        <div>
          <img src="facebook.svg" alt="facebook" />
          <h4 class="facebook-value"></h4>
          <h3>Друзей</h3>
        </div>
        <div>
          <img src="twitter.svg" alt="twitter" />
          <h4 class="twitter-value"></h4>
          <h3>Постов</h3>
        </div>
      </div>
      <script>
        const lerp = (start, end, t) => start + (end - start) * t;
        const easeOut = (t) => 1 - Math.pow(1 - t, 2);

        let youtubeSpan = document.querySelector(".youtube-value");
        let linkedinSpan = document.querySelector(".linkedin-value");
        let facebookSpan = document.querySelector(".facebook-value");
        let twitterSpan = document.querySelector(".twitter-value");
        let youtubeValue = 9000;
        let linkedinValue = 1000;
        let facebookValue = 7000;
        let twitterValue = 5000;
        let interval;
        let t = 0;
        function valueInterpolate() {
          t += 0.01;
          youtubeSpan.innerText = Math.round(lerp(0, youtubeValue, easeOut(t)));
          linkedinSpan.innerText = Math.round(
            lerp(0, linkedinValue, easeOut(t))
          );
          facebookSpan.innerText = Math.round(
            lerp(0, facebookValue, easeOut(t))
          );
          twitterSpan.innerText = Math.round(lerp(0, twitterValue, easeOut(t)));
          if (youtubeSpan.innerText == youtubeValue) clearInterval(interval);
        }
        interval = setInterval(valueInterpolate, 20);
      </script>
    </section>
    <section>
      <div class="login-window">
        <h1>Логин</h1>
        <div>
          <input id="email" type="text" placeholder="Почта" />
          <i class="fi fi-sr-envelope"></i>
          <i class="fi fi-sr-exclamation email-error-icon"></i>
          <span class="email-error"></span>
        </div>
        <div>
          <input id="password" type="password" placeholder="Пароль" />
          <i class="fi fi-sr-lock"></i>
          <i class="fi fi-sr-exclamation password-error-icon"></i>
          <span class="password-error"></span>
        </div>
        <span class="forgot-password">Забыли пароль?</span>
        <button onclick="login()">Войти</button>
        <span
          >Нет аккаунта? <span class="register">Зарегистрируйтесь!</span></span
        >
      </div>
      <script>
        const emailInput = document.querySelector("#email");
        const passwordInput = document.querySelector("#password");
        const emailDiv = emailInput.parentElement;
        const passwordDiv = passwordInput.parentElement;
        const emailError = document.querySelector(".email-error");
        const passwordError = document.querySelector(".password-error");
        const emailErrorIcon = document.querySelector(".email-error-icon");
        const passwordErrorIcon = document.querySelector(
          ".password-error-icon"
        );
        const login = () => {
          let goodEmail = true;
          let goodPassword = true;
          if (emailInput.value == "") {
            goodEmail = false;
            emailError.innerText = "Это поле не может быть пустым";
            emailErrorIcon.style.display = "inline";
            emailInput.classList.add("error-input");
            emailDiv.classList.add("error-animate");
            setTimeout(() => emailDiv.classList.remove("error-animate"), 500);
          } else if (!/^\w+@\w+\.\w+/.test(emailInput.value)) {
            goodEmail = false;
            emailError.innerText = "Введите правильный адрес";
            emailErrorIcon.style.display = "inline";
            emailInput.classList.add("error-input");
            emailDiv.classList.add("error-animate");
            setTimeout(() => emailDiv.classList.remove("error-animate"), 500);
          } else {
            emailError.innerText = "";
            emailErrorIcon.style.display = "none";
            emailInput.classList.remove("error-input");
          }
          if (passwordInput.value == "") {
            goodPassword = false;
            passwordError.innerText = "Это поле не может быть пустым";
            passwordErrorIcon.style.display = "inline";
            passwordInput.classList.add("error-input");
            passwordDiv.classList.add("error-animate");
            setTimeout(
              () => passwordDiv.classList.remove("error-animate"),
              500
            );
          } else {
            passwordError.innerText = "";
            passwordErrorIcon.style.display = "none";
            passwordInput.classList.remove("error-input");
          }
          if (goodEmail && goodPassword)
            document.location.href = "https://www.google.ru/";
        };
      </script>
    </section>
    <section>
      <div class="rating-window">
        <div class="rating">
          <img src="star.png" alt="*" />
          <img src="star.png" alt="*" />
          <img src="star.png" alt="*" />
          <img src="star.png" alt="*" />
          <img src="star.png" alt="*" />
        </div>
        <h1>ЭТО ШЕДЕВР 😍</h1>
        <textarea
          name="message"
          id="message"
          rows="4"
          placeholder="Поделитесь своим опытом"
        ></textarea>
        <button onclick="sendReview()">Отправить</button>
        <div class="thanks-panel">
          <h2>Спасибо за отзыв!</h2>
          <span>Изменить</span>
        </div>
      </div>
      <script>
        const messages = [
          "УЖАСНО 💩",
          "ПЛОХО 🙁",
          "СОЙДЁТ 😏",
          "ХОРОШО 😀",
          "ЭТО ШЕДЕВР 😍",
        ];
        const selectStar = (index) => {
          for (let i = 0; i <= index; i++) {
            stars[i].classList.add("star-hover");
          }
        };
        let ratingWindow = document.querySelector(".rating-window");
        let stars = ratingWindow.querySelectorAll("img");
        let messageH1 = ratingWindow.querySelector("h1");
        let thanksPanel = ratingWindow.querySelector(".thanks-panel");
        stars.forEach((star, index) => {
          star.onmouseenter = () => {
            for (let i = 0; i <= index; i++)
              stars[i].classList.add("star-hover");
          };
          star.onmouseleave = () => {
            stars.forEach((star) => {
              star.classList.remove("star-hover");
            });
          };
          star.onclick = () => {
            stars.forEach((star) => {
              star.classList.remove("star-hover", "star-select");
            });
            for (let i = 0; i <= index; i++)
              stars[i].classList.add("star-select");
            ratingWindow.classList.add("opened");
            messageH1.innerText = messages[index];
          };
        });
        thanksPanel.querySelector("span").onclick = () => {
          thanksPanel.classList.remove("shown");
          ratingWindow.classList.add("opened");
        };
        const sendReview = () => {
          ratingWindow.classList.remove("opened");
          thanksPanel.classList.add("shown");
        };
      </script>
    </section>
  </body>
</html>
